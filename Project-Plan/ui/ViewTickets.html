<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="Styling.css">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToDo List</title>
</head>

<body>
<table class="table table-responsive">
     <thead>
         <tr>
             <th>Ticket ID</th>
             <th>User ID</th>
             <th>Flight #</th>
             <th>First Name</th>
             <th>Last Name</th>
             <th>Check-In</th>
             <th>Cancel</th>
         </tr>
     </thead>
        <tbody id="TicketTable">
        </tbody>
</table>


    <script>
        /*
            {
        "ticket_id": 1,
        "user": {
            "user_id": 2,
            "first_name": "Spring",
            "last_name": "Ellington",
            "flight": {
                "flight_num": 5,
                "origin": "New York City",
                "destination": "Atlanta",
                "date": "November 1",
                "time": "1 PM",
                "tickets": [],
                "user": null
            },
            "tickets": []
        },
        "flight": {
            "flight_num": 5,
            "origin": "New York City",
            "destination": "Atlanta",
            "date": "November 1",
            "time": "1 PM",
            "tickets": [],
            "user": null
        },
        "first_name": "Kayla",
        "last_name": "Cleo",
        "checkIn": false,
        "cancel": false
    },
        */
        
        (async function retrieveTickets() {
             let response = await fetch("http://localhost:8080/Project-1/tickets");
             let json = await response.json();
             let table = document.getElementById("TicketTable");
                 for (let element of json) { 
                    let tr = table.insertRow(-1);
                    /*
                    Here include logic that  "explodes" the "element" of json, 
                    and prepare an object that has only the fields that are 
                    about to be mapped into the table below.
                    */
                    // let {ticket_id, user:{user_id}, flight:{flight_num}, first_name, last_name, checkIn, cancel} = tableEntry;
                    for (let key in element) {
                        let cell = tr.insertCell(-1);
                        if (key === "user"){
                            for (let key2 in element[key]){
                               if (key2 === "user_id"){
                                   cell.innerHTML = element[key][key2];
                               }
                            }
                        } else if (key === "flight"){
                            for (let key2 in element[key]){
                                if (key2 === "flight_num"){
                                   cell.innerHTML = element[key][key2];
                               }
                            }
                        // } else if (key === "checkIn" || key === "cancel"){
                        //     let check = cell.createElement("INPUT");
                        //     cell.setAttribute("type", "checkbox");
                        // } 
                        } else {
                            cell.innerHTML = element[key];
                        }
                    }
                }
            })();

    </script>
</body>

</html>